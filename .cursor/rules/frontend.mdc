---
description: "Next.js + Ant Design frontend development rules"
globs: ["frontend/**"]
alwaysApply: false
---

# Frontend Rules (Next.js + Ant Design)

> **Documentation:** `.claude/`
> - **Agents:** `.claude/agents/` (developer, reviewer, architect, tester)
> - **Guides:** `.claude/guides/frontend/`

## Agent Context

When working on frontend code, act as **@developer** agent:
- Read `.claude/agents/developer.md` for principles
- Read `.claude/guides/frontend/` for patterns

## Critical Rules

1. **Use Ant Design** - Don't recreate existing components
2. **Use Omnify types** - Import from `@/types/model`, don't duplicate
3. **Use i18n** - Use `useTranslations()` for UI text
4. **Service Layer** - API calls in `services/`, not components
5. **TanStack Query** - For all server state, no `useState` + `useEffect`

## Quick Patterns

### Service

```typescript
export const userService = {
  list: (params?: UserListParams) => api.get("/api/users", { params }).then(r => r.data),
  create: (input: UserCreate) => api.post("/api/users", input).then(r => r.data.data),
};
```

### Query

```typescript
const { data, isLoading } = useQuery({
  queryKey: queryKeys.users.list(filters),
  queryFn: () => userService.list(filters),
});
```

### Mutation

```typescript
const mutation = useMutation({
  mutationFn: userService.create,
  onSuccess: () => {
    queryClient.invalidateQueries({ queryKey: queryKeys.users.all });
    message.success(t("messages.created"));
  },
  onError: (error) => form.setFields(getFormErrors(error)),
});
```

## Types Rule

```typescript
// ✅ Use Omnify-generated types
import type { User, UserCreate } from "@/types/model";

// ✅ Only define query params locally
export interface UserListParams { ... }

// ❌ Don't redefine Omnify types
export interface UserCreateInput { ... }  // WRONG
```

## File Location

| What                    | Where                 |
| ----------------------- | --------------------- |
| Component (1 feature)   | `features/{feature}/` |
| Component (2+ features) | `components/common/`  |
| Service (API)           | `services/` (ALWAYS)  |
| Hook (1 feature)        | `features/{feature}/` |
| Hook (2+ features)      | `hooks/`              |

## Ant Design v6 Deprecated Props

| Deprecated                 | Use Instead             |
| -------------------------- | ----------------------- |
| `visible`                  | `open`                  |
| `direction` (Space)        | `orientation`           |
| `dropdownMatchSelectWidth` | `popupMatchSelectWidth` |

## Common Mistakes

```typescript
// ❌ Wrong
useEffect(() => { fetchData() }, []);  // Use useQuery
const [users, setUsers] = useState([]);  // Use TanStack for server state
<Button>Save</Button>  // Use i18n

// ✅ Correct
const { data } = useQuery({ queryKey, queryFn });
<Button>{t("common.save")}</Button>
```
